Metadata-Version: 2.4
Name: flood_bandit
Version: 0.1.0
Summary: Optimal levee height selection using multi-armed bandit algorithms
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: numpy
Requires-Dist: scipy
Requires-Dist: matplotlib
Requires-Dist: pandas
Requires-Dist: jupyter
Provides-Extra: gpu
Requires-Dist: cupy; extra == "gpu"

# Flood Bandit: Optimal Levee Height Selection

This repository implements a risk-neutral levee height selection algorithm using multi-armed bandit frameworks. The goal is to identify the optimal levee design height from a discrete set of candidates by balancing expected flood damage costs against construction (protection) costs.

The project explores different bandit strategies, including:
*   **Standard Pure Exploration**: Using Hoeffding-based confidence intervals and deterministic pruning.
*   **GPU-Accelerated Simulation**: High-throughput Monte Carlo simulations for rapid estimation.
*   **Dueling Bandits**: A preference-based approach to compare levee designs.

## Project Structure

```
flood_bandit/
├── data/                   # Input data (cost curves, sea level projections)
├── notebooks/              # Jupyter notebooks for analysis and experiments
│   ├── 01_hazard_modeling.ipynb    # Flood hazard modeling (Poisson-GPD)
│   ├── 02_data_prep.ipynb          # Data cleaning and preparation
│   ├── 03_main_experiment_gpu.ipynb # Main experiment using GPU acceleration
│   └── 04_dueling_experiment.ipynb # Experiments with dueling bandit algorithms
├── src/                    # Source code
│   ├── bandit_cpu.py       # CPU-based bandit implementation with pruning
│   ├── bandit_gpu.py       # GPU-accelerated bandit implementation (requires CuPy)
│   └── bandit_dueling.py   # Dueling bandit implementation
├── requirements.txt        # Python dependencies
└── README.md               # This file
```

## Installation

1.  **Clone the repository** (if applicable) or navigate to the project directory.

2.  **Create a virtual environment** (recommended):
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows: venv\Scripts\activate
    ```

3.  **Install the package in editable mode**:
    This installs the project dependencies and allows you to import the `src` modules as a package (`flood_bandit`) without modifying `sys.path`.
    ```bash
    pip install -e .
    ```
    *Note: If you want to run the GPU-accelerated experiments, ensure you have a CUDA-capable GPU and install the appropriate version of CuPy (e.g., `pip install cupy-cuda12x`).*

## Usage

The core analysis is performed in the Jupyter notebooks located in the `notebooks/` directory.

1.  **Start Jupyter Lab or Notebook**:
    ```bash
    jupyter lab
    ```

2.  **Run the Notebooks**:
    *   Start with `01_hazard_modeling.ipynb` to understand the underlying flood risk model.
    *   Use `02_data_prep.ipynb` to see how the cost curves are processed.
    *   Run `03_main_experiment_gpu.ipynb` to execute the main optimization loop (requires GPU setup, or modification to use CPU).
    *   Explore `04_dueling_experiment.ipynb` for alternative bandit formulations.

## Data Description

The `data/` directory contains:
*   `Damage_cost_curves.tab`: Tab-separated values for damage costs at different flood heights for various cities.
*   `Protection_cost_curves_*.tab`: Construction costs for levees at different heights.
*   `*.npz`: Compressed NumPy files containing pre-computed sea level projections or posterior parameters for the hazard models.

## Methodology

The algorithm proceeds in three main stages (as implemented in `src/bandit_cpu.py`):

1.  **Data Ingestion**: Loading damage and protection cost curves.
2.  **Pruning**: Using distribution-free lower bounds to remove suboptimal levee heights before simulation.
3.  **Pure Exploration**: Sampling flood scenarios and updating confidence intervals for the mean total cost of each surviving candidate height until an optimal one is identified.

## License

[Insert License Information Here]
